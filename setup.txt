"""
Setting WAP on Pi

Commands:
1. Install dnsmasq and hostapd
   sudo apt install dnsmasq hostapd netfilter-persistent iptables-persistent iptables

2. Stop the services
   sudo systemctl stop dnsmasq
   sudo systemctl stop hostapd

3. Configure static IP for wlan0
   sudo nano /etc/dhcpcd.conf
   interface wlan0
      static ip_address=192.168.4.1/24
      nohook wpa_supplicant

4. Restart dhcpcd service
   sudo service dhcpcd restart

5. Backup and configure dnsmasq
   sudo mv /etc/dnsmasq.conf /etc/dnsmasq.conf.orig # backup
   sudo nano /etc/dnsmasq.conf
   interface=wlan0
   dhcp-range=192.168.4.2,192.168.4.20,255.255.255.0,24h

6. set ip on wlan0
   sudo nano /etc/network/interfaces
   allow-hotplug wlan0
   iface wlan0 inet static
      address 192.168.42.1
      netmask 255.255.255.0

     
6. Start dnsmasq
   sudo systemctl start dnsmasq

7. Configure hostapd
   sudo nano /etc/hostapd/hostapd.conf
   interface=wlan0
   ssid=oasis
   channel=9
   auth_algs=1
   wpa=2
   wpa_passphrase=oasis2025
   wpa_key_mgmt=WPA-PSK
   wpa_pairwise=TKIP CCMP
   rsn_pairwise=CCMP

8. Set the hostapd configuration
   sudo nano /etc/default/hostapd
   DAEMON_CONF="/etc/hostapd/hostapd.conf"

9. Enable and start hostapd
   sudo systemctl unmask hostapd
   sudo systemctl enable hostapd
   sudo systemctl start hostapd

10. Enable routing and IP forwarding
    sudo nano /etc/sysctl.conf
    # Uncomment: net.ipv4.ip_forward=1

11. Set up IP masquerading (NAT) when we need to connect oasis users to internet once available
    sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

12. save to interface
      sudo sh -c "iptables-save > /etc/iptables/rules.v4"
      sudo nano /etc/network/interfaces
      add 
      up iptables-restore < /etc/iptables.ipv4.nat

12. Save firewall rules
    sudo netfilter-persistent save
"""